filter(park %in% c("PRIM"))
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Pacific_rim_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
#look at the ndvi trend in Pacific Rim ----
Waterton_NDVI <- all_ndvi %>%
filter(park %in% c("WATE"))
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Waterton_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
plot(all_ndvi_gam, pages = 1)
# Loading packages ----
options(timeout = max(1000, getOption("timeout")))
library(lattice) # for making graphs
library(knitr) # for knitting
library(ggplot2) # for scatter plot
library(dplyr) # for pipes
library(skimr) # for skimming data
library(tidyverse) #summing
library(lubridate) #convert whole columns to dates
library(zoo) #dates as year month
library(canadianmaps) #import annotated map of Canada
library(sf) # spatial data
library(sp) #Spatial Points function
library(rstudioapi) #for creating colour palette
library(grDevices) #for creating colour palette
library(fBasics) #for creating colour palette
library(mgcv) #gam
library(terra) #shape file
library(xml2)
library(rvest)
library(raster)
# ndvi trend across parks
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = NDVI_2000_2021, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
# ndvi trend across parks
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = NDVI_2000_2021, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
geom_smooth(data = NDVI_2000_2021, aes(x = year_month, y = ndvi_monthly_mean, col = park),method = "lm") +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
# plot HWI with NDVI residuals ----
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = hwi_ndvi, aes(x = residuals, y = HWI, col = park)) +
geom_smooth(data = hwi_ndvi, aes(x = residuals, y = HWI, col = park),method = "lm") +
xlab("Residuals") +
ylab("HWI") +
scale_y_log10() +
theme_bw() +
geom_vline(xintercept = 0, linetype = "solid", color = "black", size = 0.3) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
# ndvi trend across parks
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = NDVI_2000_2021, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
geom_vline(xintercept = 0, linetype = "solid", color = "black", size = 0.3) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
# ndvi trend across parks
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = NDVI_2000_2021, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
geom_smooth(data = NDVI_2000_2021, aes(x = year_month, y = ndvi_monthly_mean, col = park),method = "lm") +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
# geom_vline(xintercept = 0, linetype = "solid", color = "black", size = 0.3) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Ivvavik_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Five_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Pacific_rim_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Waterton_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
plot(all_ndvi_gam, pages = 1)
# Loading packages ----
options(timeout = max(1000, getOption("timeout")))
library(lattice) # for making graphs
library(knitr) # for knitting
library(ggplot2) # for scatter plot
library(dplyr) # for pipes
library(skimr) # for skimming data
library(tidyverse) #summing
library(lubridate) #convert whole columns to dates
library(zoo) #dates as year month
library(canadianmaps) #import annotated map of Canada
library(sf) # spatial data
library(sp) #Spatial Points function
library(rstudioapi) #for creating colour palette
library(grDevices) #for creating colour palette
library(fBasics) #for creating colour palette
library(mgcv) #gam
library(terra) #shape file
library(xml2)
library(rvest)
library(raster)
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Five_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
options(timeout = max(1000, getOption("timeout")))
library(lattice) # for making graphs
library(knitr) # for knitting
library(ggplot2) # for scatter plot
library(dplyr) # for pipes
library(skimr) # for skimming data
library(tidyverse) #summing
library(lubridate) #convert whole columns to dates
library(zoo) #dates as year month
library(canadianmaps) #import annotated map of Canada
library(sf) # spatial data
library(sp) #Spatial Points function
library(rstudioapi) #for creating colour palette
library(grDevices) #for creating colour palette
library(fBasics) #for creating colour palette
library(mgcv) #gam
library(terra) #shape file
library(xml2)
library(rvest)
library(raster)
View(NDVI_2000_2021)
plot(all_ndvi_gam, pages = 1)
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Jasper_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = Ivvavik_NDVI, aes(x = year_month, y = ndvi_monthly_mean, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Monthly Mean NDVI") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
# plot HWI with NDVI residuals ----
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = hwi_ndvi, aes(x = residuals, y = HWI, col = park)) +
geom_smooth(data = hwi_ndvi, aes(x = residuals, y = HWI, col = park),method = "lm") +
xlab("Residuals") +
ylab("HWI") +
scale_y_log10() +
scale_colour_manual(name="Region",
values = manual_colors) +
theme_bw() +
geom_vline(xintercept = 0, linetype = "solid", color = "black", size = 0.3) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
#plot the trend of residuals by year_month ----
ggplot() +
geom_hline(aes(yintercept = 0), col = "grey70", linetype = "dashed") +
geom_point(data = all_ndvi, aes(x = year_month, y = residuals, col = park)) +
#scale_x_continuous(limits = c(2010,2021), expand = c(0,1)) +
scale_colour_manual(name="Region",
values = manual_colors) +
xlab("Time") +
ylab("Residuals") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.y = element_text(size=12, family = "sans", face = "bold"),
axis.title.x = element_text(size=12, family = "sans", face = "bold"),
axis.text.y = element_text(size=10, family = "sans"),
axis.text.x  = element_text(size=10, family = "sans"),
legend.position = "right",
legend.title = element_text(face = "bold"),
legend.background = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = NA),
plot.margin = unit(c(0.2,0.1,0.2,0.2), "cm"))
plot(all_ndvi_gam, pages = 1)
# GAM
all_ndvi_gam <-
gam(
scaled_mean_ndvi ~ #scale ndvi from 0 to 1 to fit beta distribution
# fixed effects
park +
# global smooths
s(month, bs = "cc", k = 6) + #month effect k = 4
s(year, k = 8) + #year effect k = 8
ti(month, year, k = 6), #month/ year interaction k = 6
family = "betar",
#beta location scale distribution for the data
data = NDVI_2000_2021,
method = 'fREML'
)
plot(all_ndvi_gam, pages = 1)
# GAM
all_ndvi_gam <-
gam(
scaled_mean_ndvi ~ #scale ndvi from 0 to 1 to fit beta distribution
# fixed effects
park +
# global smooths
s(month, bs = "cc", k = 4) + #month effect k = 4
s(year, k = 8) + #year effect k = 8
ti(month, year, k = 6), #month/ year interaction k = 6
family = "betar",
#beta location scale distribution for the data
data = NDVI_2000_2021,
method = 'fREML'
)
plot(all_ndvi_gam, pages = 1)
# GAM
all_ndvi_gam <-
gam(
scaled_mean_ndvi ~ #scale ndvi from 0 to 1 to fit beta distribution
# fixed effects
park +
# global smooths
s(month, bs = "cc", k = 4) + #month effect k = 4
s(year, k = 12) + #year effect k = 8
ti(month, year, k = 6), #month/ year interaction k = 6
family = "betar",
#beta location scale distribution for the data
data = NDVI_2000_2021,
method = 'fREML'
)
plot(all_ndvi_gam, pages = 1)
# GAM
all_ndvi_gam <-
gam(
scaled_mean_ndvi ~ #scale ndvi from 0 to 1 to fit beta distribution
# fixed effects
park +
# global smooths
s(month, bs = "cc", k = 4) + #month effect k = 4
s(year, k = 8) + #year effect k = 8
ti(month, year, k = 6), #month/ year interaction k = 6
family = "betar",
#beta location scale distribution for the data
data = NDVI_2000_2021,
method = 'fREML'
)
plot(all_ndvi_gam, pages = 1)
options(timeout = max(1000, getOption("timeout")))
library(lattice) # for making graphs
library(knitr) # for knitting
library(ggplot2) # for scatter plot
library(dplyr) # for pipes
library(skimr) # for skimming data
library(tidyverse) #summing
library(lubridate) #convert whole columns to dates
library(zoo) #dates as year month
library(canadianmaps) #import annotated map of Canada
library(sf) # spatial data
library(sp) #Spatial Points function
library(rstudioapi) #for creating colour palette
library(grDevices) #for creating colour palette
library(fBasics) #for creating colour palette
library(mgcv) #gam
library(terra) #shape file
library(xml2)
library(rvest)
library(raster)
# merge all_ndvi with hwi
all_hwi_ndvi <- cbind(all_ndvi, HWI_dropped)
# merge all_ndvi with hwi
all_hwi_ndvi <- rbind(all_ndvi, HWI_dropped)
# merge all_ndvi with hwi
all_hwi_ndvi <- merge(all_ndvi, HWI_dropped)
View(all_hwi_ndvi)
View(HWI_NDVI)
